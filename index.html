<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Belajar Gamelan Interaktif</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<style>
body {
    margin: 0;
    overflow: hidden;
    background: #111;
    color: white;
    font-family: Arial, sans-serif;
}

#canvas-container {
    position: absolute;
    width: 100%;
    height: 100%;
}

.controls {
    position: absolute;
    bottom: 20px;
    width: 100%;
    text-align: center;
}

button {
    padding: 12px 20px;
    margin: 5px;
    border: none;
    border-radius: 25px;
    background: gold;
    font-weight: bold;
    cursor: pointer;
}

#loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
</style>
</head>

<body>

<div id="loading">Memuat 3D...</div>
<div id="canvas-container"></div>

<div class="controls">
    <button onclick="playGong()">ðŸ”´ Mainkan Gong</button>
    <button onclick="showEnergy()">âš¡ Lihat Energi</button>
    <button onclick="resetScene()">ðŸ”„ Reset</button>
</div>
<script>

// ===== SCENE =====
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);

// ===== CAMERA =====
const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.set(0, 3, 8);
camera.lookAt(0, 0, 0);

// ===== RENDERER =====
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMap.enabled = true;
document.getElementById("canvas-container").appendChild(renderer.domElement);

// ===== LIGHTING (lebih dramatis) =====
const ambient = new THREE.AmbientLight(0xffffff, 0.6);
scene.add(ambient);

const spotLight = new THREE.SpotLight(0xffffff, 1);
spotLight.position.set(5, 10, 5);
spotLight.castShadow = true;
scene.add(spotLight);

// ===== FLOOR (biar gak ngambang) =====
const floorGeo = new THREE.PlaneGeometry(30, 30);
const floorMat = new THREE.MeshStandardMaterial({ color: 0x222222 });
const floor = new THREE.Mesh(floorGeo, floorMat);
floor.rotation.x = -Math.PI / 2;
floor.receiveShadow = true;
scene.add(floor);

// ===== GONG =====
const geometry = new THREE.CylinderGeometry(3, 3, 0.6, 64);
const material = new THREE.MeshStandardMaterial({
  color: 0xd4af37,
  metalness: 1,
  roughness: 0.2
});

const gong = new THREE.Mesh(geometry, material);
gong.rotation.x = Math.PI / 2;
gong.castShadow = true;
gong.position.y = 2;
scene.add(gong);

// ===== ANIMASI =====
let vibrating = false;

function animate() {
  requestAnimationFrame(animate);

  if (vibrating) {
    const t = Date.now() * 0.05;
    gong.scale.x = 1 + Math.sin(t) * 0.03;
    gong.scale.y = 1 + Math.sin(t) * 0.03;
  } else {
    gong.scale.set(1,1,1);
  }

  gong.rotation.z += 0.002;

  renderer.render(scene, camera);
}

animate();

// ===== INTERAKSI =====
function playGong() {
  vibrating = true;

  if ("speechSynthesis" in window) {
    const u = new SpeechSynthesisUtterance("Ini adalah Gong. Suara muncul karena getaran.");
    u.lang = "id-ID";
    speechSynthesis.speak(u);
  }

  setTimeout(()=> vibrating = false, 1000);
}
function showEnergy() {
  const original = gong.material.color.getHex();
  gong.material.color.setHex(0xff0000);
  gong.scale.set(1.3, 1.3, 1.3);

  setTimeout(() => {
    gong.material.color.setHex(original);
    gong.scale.set(1,1,1);
  }, 800);
}

function resetScene() {
  vibrating = false;
  gong.scale.set(1,1,1);
  gong.material.color.setHex(0xd4af37);
  camera.position.set(0,3,8);
}

</script>

</body>
</html>
